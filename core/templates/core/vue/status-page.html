{% extends "../vue/header.html" %}
{% load staticfiles %}

{% block body %}

<div id="app" >
    <b-container class="main-container">
      <b-card class="main-card">
      <Row v-for="sample in samples" :sample="sample"/>\
      </b-card> 
    </b-container>
</div>
<script>


var Row =  {
  props: ['sample'],
  template: `
    <div class="status-row">
      <md-button
      :class="sample.show ? 'collapsed' : null"
      :aria-expanded="sample.show ? 'true' : 'false'"
      :aria-controls="sample.name"
      @click="sample.show = !sample.show">ID {% verbatim %}{{sample.id}}{% endverbatim %}</md-button>
      <md-button disabled style="color: black;" >DEscription</md-button>
      <md-button disabled style="color: black;">{% verbatim %}{{sample.name}}{% endverbatim %}</md-button>

      <b-collapse v-if="sample.show" :id="sample.name" v-model="sample.show" class="mt-2">
        <div v-if="sample.dlplibraries.length">
          <div v-for="library in sample.dlplibraries">

            <div v-if="library.analyses">
                <md-table md-card>
                    <md-table-toolbar>
                      <md-button disabled class="btn-small">Library</md-button>
                      <md-button class="btn-small">{% verbatim %}{{library.library}}{% endverbatim %}</md-button>
                    </md-table-toolbar>

                    <md-table-row>
                      <md-table-head>JIRA</md-table-head>
                      <md-table-head>Submission</md-table-head>
                      <md-table-head>Lanes</md-table-head>
                      <md-table-head>DLP+</md-table-head>
                      <md-table-head>Align</md-table-head>
                      <md-table-head>hmmcopy</md-table-head>
                      <md-table-head>pseudobulk</md-table-head>
                    </md-table-row>
                    
                    <div v-for="analysis in library.analyses">
                    </div>
                </md-table>
            </div>
            <div v-else>
              <md-button disabled class="btn-lrg">Np DLP Analysis on Library {% verbatim %}{{library.library}}{% endverbatim %}</md-button>
            </div>
          </div>
        </div>
        <div v-else>
          <md-button disabled class="btn-lrg">Np DLP Library</md-button>
        </div>
      </b-collapse>
    </div>
  `
  }
          

  new Vue({
    el: '#app',
    data: {
      samples: []
    },
    methods: {
      axiosGetSamples () {
        let token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxOCwidXNlcm5hbWUiOiJzc29uZyIsImV4cCI6MTU2Mjk3NTIyOCwiZW1haWwiOiIiLCJvcmlnX2lhdCI6MTU2MjM3MDQyOH0.OGyLNiP476J31Bs2zYuvRJVQO7vL4A3FIZARV_J-Cpo"
        let url = "http://127.0.0.1:8001/api/analysis/"
        axios
        .get(url,{
          headers : {
            Authorization : 'JWT ' + token
          }
        })
        .then(r => {
          resolve("success")
        })
        .catch(e => {
        })
      }
    },
    components:{
      Row
    },
    created () {
      console.log("CREATED")
      this.axiosGetSamples()
      
      this.samples = JSON.parse(unescape("{{samples| safe | escapejs}}"))
      console.log(this.samples)
    },
  })
</script>

<style>
.main-card {
  margin-top: 100px;
  width: 1200px;
  height: 600px;
    

}

#app {
  background-color: beige;
  height: 100vh;
}

body {
  background-color: beige;
}
</style>

{% endblock %}

