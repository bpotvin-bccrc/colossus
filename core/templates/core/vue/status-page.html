{% extends "../vue/header.html" %}
{% load staticfiles %}

{% block body %}

<div id="app" class="centre-focus">
    <div >
        <div class="centre-focus">
          <div>
            <md-content class="sidemenu">
            </md-content>
          </div>
          <div >
            <md-content class="topmenu">
                {% include "core/vue/status-header.html" %}
            </md-content>     
            <md-content class="maincontent">
              <Row v-for="sample in samples" :sample="sample"/>
            </md-content>
          </div>
        </div>
      </div>
</div>
<script>


var Row =  {
  props: ['sample'],
  template: `
    <div class="status-row">
      <md-button
      :class="sample.show ? 'collapsed' : null"
      :aria-expanded="sample.show ? 'true' : 'false'"
      :aria-controls="sample.name"
      @click="sample.show = !sample.show">ID {% verbatim %}{{sample.id}}{% endverbatim %}</md-button>
      <md-button disabled style="color: black;" >DEscription</md-button>
      <md-button disabled style="color: black;">{% verbatim %}{{sample.name}}{% endverbatim %}</md-button>
      <md-button disabled>DLP+</md-button>
      <md-button disabled>Align</md-button>
      <md-button disabled>hmmcopy</md-button>
      <md-button class="md-primary">pseudobulk</md-button>
      <b-collapse :id="sample.name" v-model="sample.show" class="mt-2">
        <b-card>I should start open!</b-card>
      </b-collapse>
    </div>
  `
  }
          

  new Vue({
    el: '#app',
    data: {
      samples: []
    },
    methods: {
      axiosGetSamples () {
        let token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxOCwidXNlcm5hbWUiOiJzc29uZyIsImV4cCI6MTU2Mjk3NTIyOCwiZW1haWwiOiIiLCJvcmlnX2lhdCI6MTU2MjM3MDQyOH0.OGyLNiP476J31Bs2zYuvRJVQO7vL4A3FIZARV_J-Cpo"
        let url = "http://127.0.0.1:8001/api/analysis/"
        axios
        .get(url,{
          headers : {
            Authorization : 'JWT ' + token
          }
        })
        .then(r => {
          resolve("success")
        })
        .catch(e => {
        })
      }
    },
    components:{
      Row
    },
    created () {
      console.log("CREATED")
      this.axiosGetSamples()
      
      this.samples = JSON.parse(unescape("{{samples| safe | escapejs}}"))
      console.log(this.samples)
    },
  })
</script>

<style>

span { 
    display:block;
    width:150px;
    word-wrap:break-word;
}

.md-button {
  width: 100px;
}  

.status-row {
  padding-left: 8px;
}

.topmenu {
  height: 50px;
  width:830px;  
  max-width: calc(100vw - 125px);
  display: flex;
  align-items: center;
}

.sidemenu {
  width: 260px;
  height: 68vh;
  max-width: calc(100vw - 100px);
  overflow-y : scroll;
}

.maincontent {
  height: calc(80vh - 49px);
  width:830px; 
  max-width: calc(100vw - 125px);
  overflow: scroll;
}

.centre-focus {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  height: 100vh;
  background-color: beige;
}

.md-content {
  z-index: 1;
  padding: 15px;
  margin: 0.2vh;
  position: relative;
}


</style>

{% endblock %}

